import{u as j,j as e,a as M,r as u}from"./index-DJfziI53.js";import{F as v}from"./FlexContainer-7pYeUEBP.js";import{u as C}from"./useGetData-DU7A0ete.js";import{R as P}from"./RenderQueryData-MXl8oXhH.js";import{F as N,a as w,b as F}from"./formik.esm-C_ghLgU5.js";import{G as L}from"./GridContainer-7fmX5WB_.js";import{P as E}from"./ProductItem-CIJS0b9N.js";import{B as H}from"./Divider-Cr1DzigY.js";import{M as g}from"./index-CeEDtpwb.js";import"./Img-DznJS-u6.js";const I="_sectionHeader_172iz_3",R="_categorySelector_172iz_15",k="_category_172iz_15",q="_priceForm_172iz_36",Q="_priceInput_172iz_43",p={sectionHeader:I,categorySelector:R,category:k,priceForm:q,priceInput:Q};function S({setOpen:t=null}){const{dataResponse:s,isLoading:r,isError:a}=C("categories"),[c,d]=j(),o=c.get("category")||"";function n(i){const l=new URLSearchParams(c);l.set("category",i),d(l),t(!1),window.scrollTo({top:0,left:0,behavior:"smooth"})}return e.jsxs("div",{className:p.category,children:[e.jsx("p",{className:p.sectionHeader,children:"Categories"}),e.jsx(P,{isError:a,isLoading:r,isEmptyList:s.length===0,children:e.jsxs("select",{className:p.categorySelector,onChange:i=>n(i.target.value),children:[e.jsx("option",{value:"",children:"All category"}),s.map((i,l)=>e.jsx("option",{value:i.id,selected:i.id==o,children:i.name},`catgr${l}`))]})})]})}function $({setOpen:t=()=>{}}){const[s,r]=j(),a=s.get("priceMin")||"",c=s.get("priceMax")||"";function d(o){const n=new URLSearchParams(s);n.set("priceMin",o.priceMin),n.set("priceMax",o.priceMax),r(n),t(!1),window.scrollTo({top:0,left:0,behavior:"smooth"})}return e.jsxs("div",{children:[e.jsx("p",{className:p.sectionHeader,children:"Price range"}),e.jsx(N,{initialValues:{priceMin:a,priceMax:c},className:`${p.priceForm}`,onSubmit:d,children:({handleSubmit:o})=>e.jsxs(w,{onSubmit:o,children:[e.jsxs("div",{children:[e.jsx(F,{type:"number",min:0,placeholder:"From",id:"price_from",name:"priceMin",className:p.priceInput}),e.jsx(F,{type:"number",min:0,placeholder:"To",id:"price_to",name:"priceMax",className:p.priceInput})]}),e.jsx("button",{type:"submit",className:"border-btn btn--small",children:"Search"})]})})]})}const z="_openFilterBtn_1iy5l_3",D="_sideBar_1iy5l_18",G="_open_1iy5l_3",T="_closeBtn_1iy5l_38",m={openFilterBtn:z,sideBar:D,open:G,closeBtn:T};function W({callback:t,children:s,navHeight:r}){return e.jsx("div",{style:{top:`${r}px`},className:`${m.openFilterBtn}`,onClick:()=>t(),children:s})}function O({children:t,navHeight:s,isOpen:r,setOpen:a}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`${m.sideBar} ${r&&m.open}`,style:{top:`${s-9}px`},children:[e.jsx("div",{className:m.closeBtn,onClick:()=>a(!r),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})}),t]})})}const U="_sideBar_1wqpu_2",A="_productContainer_1wqpu_13",V="_pagination_1wqpu_17",J="_currPage_1wqpu_33",x={sideBar:U,productContainer:A,pagination:V,currPage:J},K=async(t,s,r,a)=>{const c=`?categoryId=${t}&price_min=${s}&price_max=${r}&title=${a}`;return(await M.get(`https://api.escuelajs.co/api/v1/products/${c}`)).data};function X({setSearchOpen:t,isSearchOpen:s,navHeight:r}){return e.jsxs(e.Fragment,{children:[e.jsx(g,{maxWidth:650,children:e.jsxs(W,{callback:()=>t(!s),navHeight:r,children:[e.jsx("span",{className:"material-symbols-outlined",children:"filter_list"})," Filter"]})}),e.jsx(g,{maxWidth:650,children:e.jsxs(O,{isOpen:s,setOpen:t,navHeight:r,children:[e.jsx(S,{setOpen:t}),e.jsx($,{setOpen:t})]})})]})}function Y({isSearchOpen:t}){return e.jsx(g,{minWidth:651,children:e.jsxs("div",{className:`${x.sideBar} ${t&&x.open}`,children:[e.jsx(S,{}),e.jsx($,{})]})})}function Z({productList:t}){return e.jsx("div",{style:{margin:"auto"},children:e.jsx(P,{isEmptyList:t.length===0&&status!=="loading",children:e.jsx(L,{numCol:4,elClass:x.productContainer,children:t.map((s,r)=>e.jsx(E,{product:s},`product-${r}`))})})})}function ue(){const[t,s]=u.useState([]),[r,a]=u.useState(0),[c,d]=u.useState(!1),[o]=j(),n=Object.fromEntries(o.entries()),i=n.category??"",l=n.priceMin??"",y=n.priceMax??"",_=n.title??"",[b,f]=u.useState(!1),[ee,B]=u.useState();return u.useEffect(()=>{a(document.querySelector("nav").clientHeight+10),(async()=>{try{f(!0),B(null);const h=await K(i,l,y,_);s(h)}catch(h){B(h.message)}finally{f(!1)}})()},[i,l,y,_]),e.jsxs(e.Fragment,{children:[e.jsx(X,{isSearchOpen:c,setSearchOpen:d,navHeight:r}),e.jsxs(v,{gap:4,elClass:x.productContainer,children:[e.jsx(Y,{isSearchOpen:c}),!b&&e.jsx(Z,{productList:t})]}),e.jsx(H,{})]})}export{ue as default};
